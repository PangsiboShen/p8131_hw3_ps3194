---
title: "p8131_hw3_ps3194"
author: "Pangsibo Shen"
date: "2/15/2021"
output: html_document
---
```{r}
library(tidyverse)
```
### Question 1 esophageal cancer and daily alcohol consumption/ages

```{r create dataset}
age = c(25,35,45,55,65,75,25,35,45,55,65,75)
alc_level = c(0,0,0,0,0,0,1,1,1,1,1,1) #0 stands for daily alcohol 0-79g and 1 stands for daily alcohol consumption 80+g
case = c(0,5,21,34,36,8,1,4,25,42,19,5)
control = c(106,164,138,139,88,31,9,26,29,27,18,0)
```

```{r model fit}
# create a dataframe for the question
df1 = tibble(age,alc_level,case,control)
# fit a prospective model using logit link
logit_fit_1 = glm(cbind(case,control)~age+alc_level, family = binomial(link = "logit"), data = df1)
```

```{r}
summary(logit_fit_1)
#anti log for interpretation of beta
exp(logit_fit_1$coefficients)
```
The interpretation of $\beta_o$:The relative odds of disease among non-exposure is 0.0066; the odds ratio of getting esophageal cancer between people whose daily alcohol consumption greater than 80g and people whose daily alcohol consumption less than 80g is 5.9299 while holding the age as constant.

### Question 2 Orobanche seeds study
```{r}
df2 = tibble(
  yi = c(10,23,23,26,17,8,10,8,23,0,5,53,55,32,46,10,3,22,15,32,3), #number of germinating
  mi = c(39,62,81,51,39,16,30,28,45,4,6,74,72,51,79,13,12,41,30,51,7),#number of seeds
  root_extract = c(c(rep(0,10)),c(rep(1,11))),
  type = c(c(rep(0,5)),c(rep(1,5)),c(rep(0,6)),c(rep(1,5)))
) %>%
  relocate(type,root_extract,yi,mi) %>%
  mutate(type = as.factor(type), # 0 stands for O. aegyptiaca 75 and 1 stands for O. aegyptiaca 73
         root_extract = as.factor(root_extract), # 0 stands for Bean root extraction and 1 stands for cucumber root extraction 
         yi_0 = mi - yi) # number of seeds not germinating
```

##### a)

```{r}
# fit a prospective model using logit link
logit_fit_2 = glm(cbind(yi,yi_0)~type+root_extract, family = binomial(link = "logit"), data = df2)
summary(logit_fit_2)
#anti log for interpretation of beta
exp(logit_fit_2$coefficients)
```
##### b)





